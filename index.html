<html>
    <head>
        <style>
            @import url('css/baselayout.css');
            @import url('css/toolbar.css');
            @import url('css/canvas.css');
            @import url('css/color.css');

            :root {
                --menu-bar-height: 20px;

                /* Toolbar variables */
                --tool-bar-width: 80px;
                --tool-bar-button-size: 36px;
                --tool-bar-button-margin: 2px;

                /* Canvas variables */
                --resizer-size: 4px;

                /* Color bar variables */
                --bottom-bar-height: 60px;
                --color-box-size: 26px;
                --color-box-margin: 4px;
            }



        </style>

        <script type="application/javascript" src="js/basic.js"></script>
        <script type="application/javascript" src="js/color.js"></script>
        <script type="application/javascript" src="js/drawingarea.js"></script>
        <script type="application/javascript" src="js/toolbase.js"></script>
        <script type="application/javascript">

            let drawingArea = null;
            let toolManager = null;
            let toolBar = null;
            let appManager = null;

            const initApp = async function() {

                appManager = {
                    core: {
                        drawingArea: new DrawingArea(document.querySelector('.canvas-background')),
                        toolManager: new ToolManager(),
                        pluginLoader: new PluginLoader(),
                        colorManager: new ColorManager()
                    }
                }

                toolBar = new ToolBar(appManager.core.toolManager, document.querySelector('.toolbar'));
                colorBar = new ColorBar(appManager.core.colorManager, document.querySelector('.palette-bar'));
                colorPreview = new ColorPreview(appManager.core.colorManager, 
                    document.querySelector('.color-preview > .foreground-color'),
                    document.querySelector('.color-preview > .background-color'));

                await Promise.all([
                    appManager.core.pluginLoader.loadPlugin('PaintBrush'),
                    appManager.core.pluginLoader.loadPlugin('PaintLine')
                ]);
            };

            document.addEventListener('DOMContentLoaded', initApp, false);
        </script>
    </head>
    <body>
        <div class="app">
            <div class="menu-bar-container"></div>
            <div class="tools-and-canvas-container">
                <div class="tools-container">
                    <div class="toolbar"></div>
                </div>
                <div class="canvas-container">
                    <div class="canvas-background">
                        <div class="resizer br-resizer"></div>
                        <div class="resizer r-resizer"></div>
                        <div class="resizer b-resizer"></div>
                    </div>
                </div>
            </div>
            <div class="bottom-bar-container">
                <div class="color-preview">
                    <div class="background-color"></div>
                    <div class="foreground-color"></div>
                </div>
                <div class="palette-bar">
                    <div class="palette-top"></div>
                    <div class="palette-bottom"></di>
                </div>
            </div>
        </div>
    </body>
</html>